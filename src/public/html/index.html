<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8" />
  <title>SoundClone í”Œë ˆì´ë°” + ë³¼ë¥¨ ìŠ¬ë¼ì´ë” ì™„ì „ì²´</title>
  <link rel="stylesheet" href="../css/index.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
</head>

<body>
  <header class="navbar">
    <div class="logo">ğŸµ SoundClone</div>
    <nav>
      <ul class="menu">
        <li><a href="home.html">Home</a></li>
        <li><a href="library.html">Library</a></li>
      </ul>
    </nav>
    <div class="search-container">
      <input type="text" placeholder="Search for artists, bands, tracks, podcasts" />
      <button class="search-btn">ğŸ”</button>
    </div>
    
    <div class="user-buttons" id="authArea">
      <button class="upload-btn" onclick="location.href='upload.html'">Upload</button>
      <button class="more-btn">â€¢â€¢â€¢</button>
      <button class="sign-in-btn" onclick="location.href='login.html?returnTo=index.html'">Sign in</button>
      <button class="create-account-btn" onclick="location.href='signup.html'">Create account</button>
    </div>
  </header>

  <main class="main-content">
    <section class="player-section">
      <div class="player-info">
        <div id="current-track-info">
          <div class="user-name" id="artist-name">Kairikibear</div>
          <div class="track-title"id="track-title">Kairikibear - Darling Dance</div>
        </div>
        <div class="waveform-container">
          <button id="play-pause-btn" aria-label="Play/Pause">
            <span class="icon play">â–¶</span>
            <span class="icon pause">â¸</span>
          </button>
          <canvas id="waveform"></canvas>
          <div id="time-display">
            <span id="current-time">0:00</span> / <span id="duration-time">0:00</span>
          </div>
        </div>
      </div>
      <div class="album-cover-container">
        <img id="album-cover" src="../assets/albumart.jpg" alt="ì•¨ë²” ì»¤ë²„" />
      </div>
    </section>
    <section class="tracklist-section">
      <h2>ê³¡ ëª©ë¡</h2>
      <div id="tracklist"></div>
    </section>
  </main>

  <footer class="player-bar">
    <div class="player-bar-section">
      <button id="footer-play-pause-btn" class="bar-btn" aria-label="Play/Pause">
        <span class="icon play">â–¶</span>
        <span class="icon pause">â¸</span>
      </button>
      <span id="footer-current-time">0:00</span>
      <input type="range" id="progress-bar" min="0" max="100" value="0">
      <span id="footer-duration-time">0:00</span>
      <input type="range" id="volume-slider" min="0" max="100" value="80">
      <span class="volume-icon">ğŸ”Š</span>
    </div>
  </footer>
  <script src="../js/player.js"></script>

  <script>
    // --- ì¸ì¦ UI ë Œë”ë§ ìŠ¤í¬ë¦½íŠ¸ ---
    function renderAuth() {
      // 1. ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ í”„ë¡œí•„ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
      const p = JSON.parse(localStorage.getItem('profile'));
      // 2. ì œì–´í•  ì˜ì—­(id="authArea") ê°€ì ¸ì˜¤ê¸°
      const area = document.getElementById('authArea');
      
      // 3. (ì¤‘ìš”) ë¡œê·¸ì¸ ìƒíƒœì™€ ê´€ê³„ì—†ì´ í•­ìƒ ìœ ì§€ë˜ì–´ì•¼ í•˜ëŠ” ë²„íŠ¼ HTML ì •ì˜
      const uploadBtnHtml = `<button class="upload-btn" onclick="location.href='upload.html'">Upload</button>`;
      const moreBtnHtml = `<button class="more-btn">â€¢â€¢â€¢</button>`;

      if (p && area) {
        // 4. ë¡œê·¸ì¸ ìƒíƒœ (pê°€ ì¡´ì¬í•  ë•Œ)
        // [ìˆ˜ì •ë¨] Upload, More ë²„íŠ¼ì´ ë¨¼ì € ì˜¤ë„ë¡ ìˆœì„œ ë³€ê²½
        area.innerHTML = `
          ${uploadBtnHtml}
          ${moreBtnHtml}
          <div style="display:flex;align-items:center;gap:8px;cursor:pointer;">
            <img src="${p.img}" style="width:38px;height:38px;border-radius:50%;object-fit:cover;background:#eee;border:1px solid #bbb;" alt="í”„ë¡œí•„" />
            <span style="font-size:16px;color:#fff;font-weight:bold;">${p.name}</span>
            <button onclick="logout()" style="margin-left:8px;padding:5px 16px;border-radius:5px;background:#444;color:#fff;border:none;cursor:pointer;">ë¡œê·¸ì•„ì›ƒ</button>
          </div>
        `;
      } else if (area) {
        // 5. ë¡œê·¸ì•„ì›ƒ ìƒíƒœ
        // [ìˆ˜ì •ë¨] Upload, More ë²„íŠ¼ì´ ë¨¼ì € ì˜¤ë„ë¡ ìˆœì„œ ë³€ê²½
        area.innerHTML = `
          ${uploadBtnHtml}
          ${moreBtnHtml}
          <button class="sign-in-btn" onclick="location.href='login.html?returnTo=index.html'">Sign in</button>
          <button class="create-account-btn" onclick="location.href='signup.html'">Create account</button>
        `;
      }
    }

    // ë¡œê·¸ì•„ì›ƒ í•¨ìˆ˜
    function logout() {
      localStorage.removeItem('profile');
      renderAuth(); // UI ìƒˆë¡œê³ ì¹¨
    }

    // 6. í˜ì´ì§€ ë¡œë“œ ì‹œ ì¦‰ì‹œ ì¸ì¦ ìƒíƒœ í™•ì¸ ë° UI ë Œë”ë§ ì‹¤í–‰
    renderAuth();
    // --- ì¸ì¦ ìŠ¤í¬ë¦½íŠ¸ ë ---
  </script>
</body>

</html>